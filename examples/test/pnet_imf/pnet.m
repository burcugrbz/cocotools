function [y]=pnet(x,p)
% p = [eps B]

ep = p(1,:);
B  = p(2,:);

al =     ep-B;
be = 0.5*ep-B;

y(1,:) = x(2,:);
y(2,:) = be.*x(2,:) - al.*x(2,:).^3 - (1+B.*x(3,:)).*x(1,:);

% y(2,:) = be.*x(2,:) - al.*x(2,:).^3 - (1+B.*sin(2*x(3,:))).*x(1,:);
% y(3,:) = ones(1,size(x,2));

ss     = sum(x(3,:).*x(3,:) + x(4,:).*x(4,:),1);

y(3,:) =    x(3,:) + 2*x(4,:) - x(3,:).*ss;
y(4,:) = -2*x(3,:) +   x(4,:) - x(4,:).*ss;
